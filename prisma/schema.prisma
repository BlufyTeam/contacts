generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ===================================================
// Models
// ===================================================

model Account {
  id                        String  @id @default(cuid())
  userId                    String
  type                      String
  provider                  String
  providerAccountId         String
  refresh_token             String?
  access_token              String?
  expires_at                Int?
  token_type                String?
  scope                     String?
  id_token                  String?
  session_state             String?
  refresh_token_expires_in  Int?

  user                      User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model User {
  id              String        @id @default(cuid())
  name            String?
  email           String?       @unique
  emailVerified   DateTime?
  image           String?
  extension       String?
  password        String?
  organizationId  String?
  organization    Organization? @relation(fields: [organizationId], references: [id])

  roleId          String?
  role            Role?         @relation(fields: [roleId], references: [id])

  accounts        Account[]
  sessions        Session[]

  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}

model Organization {
  id         String     @id @default(cuid())
  name       String    @unique

  users      User[]      // ðŸ‘ˆ back-relation to User
  contacts   Contact[]

  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
}

model Contact {
  id             String        @id @default(cuid())
  fullName       String
  fullnameEn    String?
  email          String        @unique
  extension      String

  organizationId String
  organization   Organization  @relation(fields: [organizationId], references: [id])


  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt

  gender       String?
  title        String?
  titleEn      String?
  personalCode String?
  BC           String?
  BCEn         String?
  edu          String?
  major        String?
  phone        String?
  mobile       String?
  hiredDate    String?
  father       String?
  birthShamsi  String?
  birthMiladi  String?
  birthLoc     String?
  marriage     String?
  childrenNum  String?
  codeMeli     String?
  shenasname   String?
  shenasnameSerial   String?
  insuranceNum   String?
  insuranceCode   String?
  insuranceTitle  String?
  passport    String?
  passportExpire   String?
  SOS String?
  personalMail  String?
  

}



model Role {
  id          String        @id @default(cuid())
  name        String        @unique
  description String?
  permissions Permission[]  @relation("RolePermissions")
  users       User[]
}

model Permission {
  id          String     @id @default(cuid())
  name        String     @unique
  description String?
  roles       Role[]     @relation("RolePermissions")
}

model ITDocument {
  id          Int      @id @default(autoincrement())
  name        String
  description String?
  fileUrl     String
  fileType    String
  createdAt   DateTime @default(now())
}
